# Обновления parser_tdnm (апстрим vs текущая вендорная копия)

На свежем апстриме изменилась CLI и организация пайплайна:

- `run_pipeline.py` теперь использует `argparse` и JSON-логирование. Появились
  новые флаги: `--per-page` (алиас к `--per_page`), `--search-in` (алиас к
  `--search_in`), `--site` (ограничение источников: `hh`, `gorodrabot`,
  `both`), `--formats` для выбора отчётов (`xlsx`/`csv`/`docx`), `--output-dir`
  для каталога выгрузки, `--keep-csv`, `--name-suffix`, `--verbose`. Если
  `--output` не указан — имя генерируется автоматически (`<slug>_<ts>.xlsx`).
  В stdout печатаются JSON-строки с путями готовых файлов.
- По умолчанию выгружается только `xlsx`, docx/csv нужно включать явно. Отчёты
  складываются в `exports/` (или в каталог из `--output-dir`).
- `parsers/fetch_vacancies.py` научился понимать алиас `--per-page` и умеет
  ограничивать источники через `--site`. Параметр `--role` стал опциональным,
  т.к. фильтр по умолчанию теперь не применён.
- Сохранились точки входа (`main.py`, `build_job_analytics.py`,
  `build_report_docx.py`), но run_pipeline больше не ожидает строго `--output`
  и аккуратно чистит временный `raw.csv`.

Дальнейшие шаги: синхронизировать вендор с апстримом и адаптировать бот.
